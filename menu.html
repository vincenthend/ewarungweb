<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>E-Warung</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css">
</head>
<body>
<div class="container">
    <div class="header">
        E-Warung
    </div>
    <div class="content">
        <div class="resto-banner">
            
        </div>

        <div class="card-content">
            <div class="content-label">Menu</div>
            <div class="content-box" id="menu">
                
            </div>
        </div>
    </div>

    <div class="bottom-panel">
        <div class="order-total">
            <div class="total-label">
                Total
            </div>
            <div class="total-number">
                230.000
            </div>
        </div>
        <div class="order-button">
            Pesan
        </div>
    </div>
</div>


<div class="notification" id="notification-confirm">
    <div class="notification-box">
        <div class="notification-section" id="alergen">
            <div class="notification-header">
                Alergen
            </div>
            <div class="notification-content">
                Mengandung telur
            </div>
        </div>

        <div class="notification-section" id="total">
            <div class="notification-header">
                Total Pesanan
            </div>
            <div class="notification-content">
                <div class="amount-box">
                    <div class="label">Pesanan</div>
                    <div class="amount">16.000</div>
                </div>
                <div class="amount-box">
                    <div class="label">Biaya Antar</div>
                    <div class="amount">106.000</div>
                </div>
                <hr>
                <div class="amount-box">
                    <div class="label">Total</div>
                    <div class="amount">16.000</div>
                </div>
            </div>
        </div>

        <div class="notification-section" id="lokasi">
            <div class="notification-header">
                Lokasi Pengantaran
            </div>
            <div class="notification-content">
                <input type="text" name="lokasi-antar" id="lokasi-antar"> <span id="edit"></span>
            </div>
        </div>

        <button type="button">Pesan</button>
    </div>
</div>
<div class="notification" id="notification-token">
    <div class="notification-box">
        <div class="notification-picture" >
            <!-- Gambar -->
        </div>

        <div class="notification-text">
            You got a reward token!
        </div>

        <button type="button">OK</button>
    </div>
</div>
<script type="text/javascript">
function getSearchParameters() {
      var prmstr = window.location.search.substr(1);
      return prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};
}

function transformToAssocArray( prmstr ) {
    var params = {};
    var prmarr = prmstr.split("&");
    for ( var i = 0; i < prmarr.length; i++) {
        var tmparr = prmarr[i].split("=");
        params[tmparr[0]] = tmparr[1];
    }
    return params;
}

var params = getSearchParameters();
var xmlhttp;
if (window.XMLHttpRequest){
    xmlhttp = new XMLHttpRequest();
} else {
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET","https://script.google.com/macros/s/AKfycbzfGm-nwmfVcwktmtFGNY6fi2rBthYV_RuqUvVA7X1z/dev?route=getWarungbyId&id=" + params.id,true);
xmlhttp.send();
xmlhttp.onreadystatechange = function () {
    if (this.readyState === 4 && this.status === 200){
        var currentRestoJSON = JSON.parse(this.response);
        var banner = document.getElementsByClassName("resto-banner")[0];
        var pic = document.createElement("div");
        pic.className = "resto-banner-pic";
        banner.appendChild(pic);
        var bannerInfo = document.createElement("div");
        bannerInfo.className = "resto-banner-info";
        banner.appendChild(bannerInfo);
        var bannerName = document.createElement("div");
        bannerName.className = "resto-name";
        bannerName.innerHTML = currentRestoJSON.result.restoName;
        bannerInfo.appendChild(bannerName);
        var bannerAdd = document.createElement("div");
        bannerAdd.className = "resto-address";
        bannerAdd.innerHTML = currentRestoJSON.result.restoLoc;
        bannerInfo.appendChild(bannerAdd);
    }
};

// Ambil data menu
var xmlhttpX;
if (window.XMLHttpRequest){
    xmlhttpX = new XMLHttpRequest();
} else {
    xmlhttpX = new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttpX.open("GET","https://script.google.com/macros/s/AKfycbzfGm-nwmfVcwktmtFGNY6fi2rBthYV_RuqUvVA7X1z/dev?route=getMenu&id=" + params.id,true);
xmlhttpX.send();
xmlhttpX.onreadystatechange = function () {
    if (this.readyState === 4 && this.status === 200){
        console.log(this.response);
        var currentMenuJSON = JSON.parse(this.response);
        // ambil id menu
        var menu = document.getElementById("menu");
        var formMenu = document.createElement("form");
        var currentMenuJSONRes = currentMenuJSON.result
        menu.appendChild(formMenu);
        for (var menu in currentMenuJSONRes){
            var menucard = document.createElement("div");
            menucard.className = "menu-card-small";
            formMenu.appendChild(menucard);
            var menupic = document.createElement("div");
            menupic.className = "menu-pic";
            menucard.appendChild(menupic);
            var menuname = document.createElement("div");
            menuname.className = "menu-name";
            menuname.innerHTML = currentMenuJSONRes[menu].nama;
            menucard.appendChild(menuname);
            var menuprice = document.createElement("div");
            menuprice.className = "menu-price";
            menuprice.innerHTML = "Rp " + currentMenuJSONRes[menu].harga;
            menucard.appendChild(menuprice);
            var menuquantity = document.createElement("div");
            menuquantity.className = "menu-quantity";
            menucard.appendChild(menuquantity);
            var btnmin = document.createElement("button");
            btnmin.className = "qty-button";
            btnmin.type="button";
            btnmin.innerHTML = "-";
            menuquantity.appendChild(btnmin);
            var btnmin = document.createElement("input");
            btnmin.className = "qty-menu";
            btnmin.type="text";
            menuquantity.appendChild(btnmin);
            var btnplus = document.createElement("button");
            btnplus.className = "qty-button";
            btnplus.type="button";
            btnplus.innerHTML = "+";
            menuquantity.appendChild(btnplus);
        }
    }
};
</script>
</body>
</html>